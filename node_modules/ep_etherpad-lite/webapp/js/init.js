/**
 * Created by hua on 2014/10/25.
 */
exports.init = function (app) {
    console.info("初始化访问路由");
    app.set("title", "协同写作系统");
    app.get("/session", function (req, res) {
		console.info("--资源访问路径为---"+req.url);
		var cookie = req.url;
		cookie = cookie.split("?")[1];
		cookie = cookie.split("&");
		var jsonp = "";
		var result="";
		var reg = /jsonp/;
		for(var i =0;i<cookie.length;i++){
			if(reg.test(cookie[i])){
				jsonp = cookie[i].split("=")[1];
			}else{
			 result+=cookie[i]+=",";
			}
		}
		result = result.substring(0,result.length-1);
		result = result.split(",");
		for(var i =0;i<result.length;i++){
			if(result[i]!=""){
				result=result[i];
				break;
			}
		}
		
		res.setHeader("Set-Cookie",result );
		res.setHeader("P3P","CP='IDC DSP COR ADM DEVi TAIi PSA PSD IVAi IVDi CONi HIS OUR IND CNT'");
        res.send(jsonp+"({'message':'ok'})");
    });
}